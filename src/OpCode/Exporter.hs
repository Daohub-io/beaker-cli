module OpCode.Exporter where

import OpCode.Type

import Prelude hiding (LT, EQ, GT)

import Control.Applicative
import Data.ByteString
import qualified Data.ByteString.Char8 as C8
import Data.Attoparsec.ByteString as A
-- import Data.Attoparsec.Binary
import Data.Char (isSpace)
import Data.List as L
import Debug.Trace

import Data.Word
import Control.Monad

import Test.QuickCheck

toByteString :: OpCode -> ByteString
toByteString STOP = pack [0x00]
toByteString ADD = pack [0x01]
toByteString MUL = pack [0x02]
toByteString SUB = pack [0x03]
toByteString DIV = pack [0x04]
toByteString SDIV = pack [0x05]
toByteString MOD = pack [0x06]
toByteString SMOD = pack [0x07]
toByteString ADDMOD = pack [0x08]
toByteString MULMOD = pack [0x09]
toByteString EXP = pack [0x0a]
toByteString SIGNEXTEND = pack [0x0b]

toByteString LT = pack [0x10]
toByteString GT = pack [0x11]
toByteString SLT = pack [0x12]
toByteString SGT = pack [0x13]
toByteString EQ = pack [0x14]
toByteString ISZERO = pack [0x15]
toByteString AND = pack [0x16]
toByteString OR = pack [0x17]
toByteString XOR = pack [0x18]
toByteString NOT = pack [0x19]
toByteString BYTE = pack [0x1a]

toByteString SHA3 = pack [0x20]

toByteString ADDRESS = pack [0x30]
toByteString BALANCE = pack [0x31]
toByteString ORIGIN = pack [0x32]
toByteString CALLER = pack [0x33]
toByteString CALLVALUE = pack [0x34]
toByteString CALLDATALOAD = pack [0x35]
toByteString CALLDATASIZE = pack [0x36]
toByteString CALLDATACOPY = pack [0x37]
toByteString CODESIZE = pack [0x38]
toByteString CODECOPY = pack [0x39]
toByteString GASPRICE = pack [0x3a]
toByteString EXTCODESIZE = pack [0x3b]
toByteString EXTCODECOPY = pack [0x3c]
toByteString RETURNDATASIZE = pack [0x3d]
toByteString RETURNDATACOPY = pack [0x3e]

toByteString BLOCKHASH = pack [0x40]
toByteString COINBASE = pack [0x41]
toByteString TIMESTAMP = pack [0x42]
toByteString NUMBER = pack [0x43]
toByteString DIFFICULTY = pack [0x44]
toByteString GASLIMIT = pack [0x45]

toByteString POP = pack [0x50]
toByteString MLOAD = pack [0x51]
toByteString MSTORE = pack [0x52]
toByteString MSTORE8 = pack [0x53]
toByteString SLOAD = pack [0x54]
toByteString SSTORE = pack [0x55]
toByteString JUMP = pack [0x56]
toByteString JUMPI = pack [0x57]
toByteString PC = pack [0x58]
toByteString MSIZE = pack [0x59]
toByteString GAS = pack [0x5a]
toByteString JUMPDEST = pack [0x5b]

toByteString (PUSH1 b1) = pack [0x60,b1]
toByteString (PUSH2 b1 b2) = pack [0x60,b1,b2]
toByteString (PUSH3 b1 b2 b3) = pack [0x60,b1,b2,b3]
toByteString (PUSH4 b1 b2 b3 b4) = pack [0x60,b1,b2,b3,b4]
toByteString (PUSH5 b1 b2 b3 b4 b5) = pack [0x60,b1,b2,b3,b4,b5]
toByteString (PUSH6 b1 b2 b3 b4 b5 b6) = pack [0x60,b1,b2,b3,b4,b5,b6]
toByteString (PUSH7 b1 b2 b3 b4 b5 b6 b7) = pack [0x60,b1,b2,b3,b4,b5,b6,b7]
toByteString (PUSH8 b1 b2 b3 b4 b5 b6 b7 b8) = pack [0x60,b1,b2,b3,b4,b5,b6,b7,b8]
toByteString (PUSH9 b1 b2 b3 b4 b5 b6 b7 b8 b9) = pack [0x60,b1,b2,b3,b4,b5,b6,b7,b8,b9]
toByteString (PUSH10 b1 b2 b3 b4 b5 b6 b7 b8 b9 b10) = pack [0x60,b1,b2,b3,b4,b5,b6,b7,b8,b9,b10]
toByteString (PUSH11 b1 b2 b3 b4 b5 b6 b7 b8 b9 b10 b11) = pack [0x60,b1,b2,b3,b4,b5,b6,b7,b8,b9,b10,b11]
toByteString (PUSH12 b1 b2 b3 b4 b5 b6 b7 b8 b9 b10 b11 b12) = pack [0x60,b1,b2,b3,b4,b5,b6,b7,b8,b9,b10,b11,b12]
toByteString (PUSH13 b1 b2 b3 b4 b5 b6 b7 b8 b9 b10 b11 b12 b13) = pack [0x60,b1,b2,b3,b4,b5,b6,b7,b8,b9,b10,b11,b12,b13]
toByteString (PUSH14 b1 b2 b3 b4 b5 b6 b7 b8 b9 b10 b11 b12 b13 b14) = pack [0x60,b1,b2,b3,b4,b5,b6,b7,b8,b9,b10,b11,b12,b13,b14]
toByteString (PUSH15 b1 b2 b3 b4 b5 b6 b7 b8 b9 b10 b11 b12 b13 b14 b15) = pack [0x60,b1,b2,b3,b4,b5,b6,b7,b8,b9,b10,b11,b12,b13,b14,b15]
toByteString (PUSH16 b1 b2 b3 b4 b5 b6 b7 b8 b9 b10 b11 b12 b13 b14 b15 b16) = pack [0x60,b1,b2,b3,b4,b5,b6,b7,b8,b9,b10,b11,b12,b13,b14,b15,b16]
toByteString (PUSH17 b1 b2 b3 b4 b5 b6 b7 b8 b9 b10 b11 b12 b13 b14 b15 b16 b17) = pack [0x60,b1,b2,b3,b4,b5,b6,b7,b8,b9,b10,b11,b12,b13,b14,b15,b16,b17]
toByteString (PUSH18 b1 b2 b3 b4 b5 b6 b7 b8 b9 b10 b11 b12 b13 b14 b15 b16 b17 b18) = pack [0x60,b1,b2,b3,b4,b5,b6,b7,b8,b9,b10,b11,b12,b13,b14,b15,b16,b17,b18]
toByteString (PUSH19 b1 b2 b3 b4 b5 b6 b7 b8 b9 b10 b11 b12 b13 b14 b15 b16 b17 b18 b19) = pack [0x60,b1,b2,b3,b4,b5,b6,b7,b8,b9,b10,b11,b12,b13,b14,b15,b16,b17,b18,b19]
toByteString (PUSH20 b1 b2 b3 b4 b5 b6 b7 b8 b9 b10 b11 b12 b13 b14 b15 b16 b17 b18 b19 b20) = pack [0x60,b1,b2,b3,b4,b5,b6,b7,b8,b9,b10,b11,b12,b13,b14,b15,b16,b17,b18,b19,b20]
toByteString (PUSH21 b1 b2 b3 b4 b5 b6 b7 b8 b9 b10 b11 b12 b13 b14 b15 b16 b17 b18 b19 b20 b21) = pack [0x60,b1,b2,b3,b4,b5,b6,b7,b8,b9,b10,b11,b12,b13,b14,b15,b16,b17,b18,b19,b20,b21]
toByteString (PUSH22 b1 b2 b3 b4 b5 b6 b7 b8 b9 b10 b11 b12 b13 b14 b15 b16 b17 b18 b19 b20 b21 b22) = pack [0x60,b1,b2,b3,b4,b5,b6,b7,b8,b9,b10,b11,b12,b13,b14,b15,b16,b17,b18,b19,b20,b21,b22]
toByteString (PUSH23 b1 b2 b3 b4 b5 b6 b7 b8 b9 b10 b11 b12 b13 b14 b15 b16 b17 b18 b19 b20 b21 b22 b23) = pack [0x60,b1,b2,b3,b4,b5,b6,b7,b8,b9,b10,b11,b12,b13,b14,b15,b16,b17,b18,b19,b20,b21,b22,b23]
toByteString (PUSH24 b1 b2 b3 b4 b5 b6 b7 b8 b9 b10 b11 b12 b13 b14 b15 b16 b17 b18 b19 b20 b21 b22 b23 b24) = pack [0x60,b1,b2,b3,b4,b5,b6,b7,b8,b9,b10,b11,b12,b13,b14,b15,b16,b17,b18,b19,b20,b21,b22,b23,b24]
toByteString (PUSH25 b1 b2 b3 b4 b5 b6 b7 b8 b9 b10 b11 b12 b13 b14 b15 b16 b17 b18 b19 b20 b21 b22 b23 b24 b25) = pack [0x60,b1,b2,b3,b4,b5,b6,b7,b8,b9,b10,b11,b12,b13,b14,b15,b16,b17,b18,b19,b20,b21,b22,b23,b24,b25]
toByteString (PUSH26 b1 b2 b3 b4 b5 b6 b7 b8 b9 b10 b11 b12 b13 b14 b15 b16 b17 b18 b19 b20 b21 b22 b23 b24 b25 b26) = pack [0x60,b1,b2,b3,b4,b5,b6,b7,b8,b9,b10,b11,b12,b13,b14,b15,b16,b17,b18,b19,b20,b21,b22,b23,b24,b25,b26]
toByteString (PUSH27 b1 b2 b3 b4 b5 b6 b7 b8 b9 b10 b11 b12 b13 b14 b15 b16 b17 b18 b19 b20 b21 b22 b23 b24 b25 b26 b27) = pack [0x60,b1,b2,b3,b4,b5,b6,b7,b8,b9,b10,b11,b12,b13,b14,b15,b16,b17,b18,b19,b20,b21,b22,b23,b24,b25,b26,b27]
toByteString (PUSH28 b1 b2 b3 b4 b5 b6 b7 b8 b9 b10 b11 b12 b13 b14 b15 b16 b17 b18 b19 b20 b21 b22 b23 b24 b25 b26 b27 b28) = pack [0x60,b1,b2,b3,b4,b5,b6,b7,b8,b9,b10,b11,b12,b13,b14,b15,b16,b17,b18,b19,b20,b21,b22,b23,b24,b25,b26,b27,b28]
toByteString (PUSH29 b1 b2 b3 b4 b5 b6 b7 b8 b9 b10 b11 b12 b13 b14 b15 b16 b17 b18 b19 b20 b21 b22 b23 b24 b25 b26 b27 b28 b29) = pack [0x60,b1,b2,b3,b4,b5,b6,b7,b8,b9,b10,b11,b12,b13,b14,b15,b16,b17,b18,b19,b20,b21,b22,b23,b24,b25,b26,b27,b28,b29]
toByteString (PUSH30 b1 b2 b3 b4 b5 b6 b7 b8 b9 b10 b11 b12 b13 b14 b15 b16 b17 b18 b19 b20 b21 b22 b23 b24 b25 b26 b27 b28 b29 b30) = pack [0x60,b1,b2,b3,b4,b5,b6,b7,b8,b9,b10,b11,b12,b13,b14,b15,b16,b17,b18,b19,b20,b21,b22,b23,b24,b25,b26,b27,b28,b29,b30]
toByteString (PUSH31 b1 b2 b3 b4 b5 b6 b7 b8 b9 b10 b11 b12 b13 b14 b15 b16 b17 b18 b19 b20 b21 b22 b23 b24 b25 b26 b27 b28 b29 b30 b31) = pack [0x60,b1,b2,b3,b4,b5,b6,b7,b8,b9,b10,b11,b12,b13,b14,b15,b16,b17,b18,b19,b20,b21,b22,b23,b24,b25,b26,b27,b28,b29,b30,b31]
toByteString (PUSH32 b1 b2 b3 b4 b5 b6 b7 b8 b9 b10 b11 b12 b13 b14 b15 b16 b17 b18 b19 b20 b21 b22 b23 b24 b25 b26 b27 b28 b29 b30 b31 b32) = pack [0x60,b1,b2,b3,b4,b5,b6,b7,b8,b9,b10,b11,b12,b13,b14,b15,b16,b17,b18,b19,b20,b21,b22,b23,b24,b25,b26,b27,b28,b29,b30,b31,b32]

toByteString DUP1 = pack [0x80]
toByteString DUP2 = pack [0x81]
toByteString DUP3 = pack [0x82]
toByteString DUP4 = pack [0x83]
toByteString DUP5 = pack [0x84]
toByteString DUP6 = pack [0x85]
toByteString DUP7 = pack [0x86]
toByteString DUP8 = pack [0x87]
toByteString DUP9 = pack [0x88]
toByteString DUP10 = pack [0x89]
toByteString DUP11 = pack [0x8a]
toByteString DUP12 = pack [0x8b]
toByteString DUP13 = pack [0x8c]
toByteString DUP14 = pack [0x8d]
toByteString DUP15 = pack [0x8e]
toByteString DUP16 = pack [0x8f]
toByteString SWAP1 = pack [0x90]
toByteString SWAP2 = pack [0x91]
toByteString SWAP3 = pack [0x92]
toByteString SWAP4 = pack [0x93]
toByteString SWAP5 = pack [0x94]
toByteString SWAP6 = pack [0x95]
toByteString SWAP7 = pack [0x96]
toByteString SWAP8 = pack [0x97]
toByteString SWAP9 = pack [0x98]
toByteString SWAP10 = pack [0x99]
toByteString SWAP11 = pack [0x9a]
toByteString SWAP12 = pack [0x9b]
toByteString SWAP13 = pack [0x9c]
toByteString SWAP14 = pack [0x9d]
toByteString SWAP15 = pack [0x9e]
toByteString SWAP16 = pack [0x9f]

toByteString LOG0 = pack [0xa0]
toByteString LOG1 = pack [0xa1]
toByteString LOG2 = pack [0xa2]
toByteString LOG3 = pack [0xa3]
toByteString LOG4 = pack [0xa4]

toByteString CREATE = pack [0xf0]
toByteString CALL = pack [0xf1]
toByteString CALLCODE = pack [0xf2]
toByteString RETURN = pack [0xf3]
toByteString DELEGATECALL = pack [0xf4]
toByteString STATICCALL = pack [0xfa]
toByteString REVERT = pack [0xfd]
toByteString INVALID = pack [0xfe]
toByteString SELFDESTRUCT = pack [0xff]
